## Preface

Internet of Things (IoT) technology has progressively infiltrated various facets of our daily lives, ranging from smart homes and connected vehicles to more complex industrial automation settings. When researching and testing these systems, there might be occasions where we're temporarily unable to acquire genuine data streams. In such scenarios, the ability to accurately simulate real data becomes paramount.

As AI technologies evolve, advanced generative AIs like ChatGPT open up a new avenue for IoT development. It can produce simulated data for various IoT scenarios as required, making the data testing and verification more efficient, realistic, and comprehensive. In this article, we will delve into integrating ChatGPT with the [MQTT client tool, MQTTX](https://mqttx.app/), with the goal of simulating and generating authentic IoT data streams.

## Why is There a Need for IoT Scenario Data Testing?

1. **System Function Verification:** Simulated data can present developers with a realistic testing environment, assisting in early identification and rectification of potential issues. This ensures the stability and reliability of the product.

2. **Enhancing Customer Experience:** When demonstrating a product to potential users or customers, simulated data from real scenarios vividly showcases the product's functionalities and advantages, enhancing their purchase intent.

3. **Storage & Performance Assessment:** With a plethora of simulated data, we can assess the system's storage requirements and predict and alleviate potential performance bottlenecks. This ensures the system operates seamlessly in a real-world setting.

4. **Rapid Prototype Design & Verification:** In the early stages of product design, simulated data aids teams in swiftly verifying the feasibility of new functions or designs, thereby reducing iteration time.

## Incorporating Generative AI into MQTT Data Testing

We're pioneering a transformative approach for real-time MQTT data testing in IoT applications by leveraging the data simulation capabilities of MQTTX and the advanced text processing expertise of LLM, such as ChatGPT. While MQTTX offers script simulation functionalities, its built-in scripts might only cater to some of your specific scenario data needs, and manually crafting test scripts can take time. With this method, we streamline and expedite this process, ensuring efficient, realistic, and comprehensive testing across various IoT scenarios.

1. **Data Requirement Analysis:** Initially, we assess the data needs of the IoT scenario, identifying the categories, structures, and formats of data that need to be simulated.

2. **Using ChatGPT to Generate Simulation Scripts:** Based on our assessment, we employ ChatGPT, an advanced large language model, to craft simulation scripts for MQTTX. This not only significantly simplifies script creation but also ensures the quality and authenticity of the data content.

3. **Simulating Data Transmission with MQTTX:** Using scripts generated by ChatGPT, MQTTX simulates device data transmissions, interacting with MQTT servers like [EMQX](https://www.emqx.io).

![Incorporating Generative AI into MQTT Data Testing](https://assets.emqx.com/images/f6980406bc52b273f7a6c5b60eed54a4.png)

Core components involved in our methodology:

- ChatGPT: Our chosen AI tool specializes in generating simulation scripts for data. With its powerful natural language processing capabilities, we can create precise and realistic simulation scripts for MQTTX.

- [MQTTX](https://mqttx.app)**:** A full-featured MQTT client tool, MQTTX boasts a custom script feature, enabling device simulation for message transmission and reception.

- [EMQX](https://www.emqx.io)**:** Our preferred MQTT server, ensuring the stable transmission of simulated data.

In the subsequent sections, we'll guide you on how to kickstart your data simulation testing.

## Quick Start

### Installing EMQX

To ensure smooth communication with IoT devices, start by installing EMQX:

```
docker run -d --name emqx -p 1883:1883 -p 8083:8083 -p 8883:8883 -p 8084:8084 -p 18083:18083 emqx/emqx:latest
```

In addition to Docker installation, EMQX supports installation using RPM or DEB packages. For more installation methods, refer to the [<u>EMQX 5.0 Installation Guide</u>](https://www.emqx.io/docs/en/v5.1/deploy/install.html). For those wanting to quickly verify without local installation, using the online [public MQTT broker](https://www.emqx.com/en/mqtt/public-mqtt5-broker): `broker.emqx.io` is recommended.

### Installing MQTTX

For macOS users, you can install it using the following command:

```
brew install emqx/mqttx/mqttx-cli
```

The MQTTX command-line tool is multi-platform supported. Depending on your operating system, visit the following link to select the appropriate installation package: [<u>Download Link</u>](https://mqttx.app/downloads).

### Writing ChatGPT Prompts

1. Start by visiting ChatGPT and logging in.

2. After logging in, navigate to the new chat interface and write prompts as illustrated below:

   ```
   First, please refer to this basic simulated data script template:
   
   /**
   * MQTTX Scenario File Example
   * 
   * This script generates random temperature and humidity data.
   */
   function generator(faker, options) {
    return {
      // If a topic is not returned, use the topic from the command line arguments.
      // Topic format: 'mqttx/simulate/myScenario/' + clientId,
      message: JSON.stringify({
        temp: faker.datatype.number({ min: 20, max: 80 }),  // Generates random temperature between 20 and 80.
        hum: faker.datatype.number({ min: 40, max: 90 }),   // Generates random humidity between 40 and 90.
      })
    }
   }
   // Export the scenario module
   module.exports = {
    name: 'myScenario',  // Scenario name
    generator,          // Generator function
   }
   
   Then, request a design for a smart home IoT scenario that includes temperature, humidity, and light sensor simulation scripts, where the script uses Faker.js.
   Please don't change the script template.
   ```

3. Once you send it following the instructions, ChatGPT will generate a simulation script for your specified scenario.

   ![generate a simulation script for your specified scenario](https://assets.emqx.com/images/2606f68754191fe9e8a3f5a1d25085f0.png) 

### Using MQTTX to Publish Simulated Data

1. For instance, for the smart home scenario mentioned above, ChatGPT might provide us with a JavaScript script similar to the following:

   ```
   /**
   * MQTTX Scenario File for Smart Home IoT
   * 
   * This script generates random temperature, humidity, and light intensity data for a smart home.
   */
   function generator(faker, options) {
    return {
      // If a topic is not returned, use the topic from the command line arguments.
      // Topic format: 'mqttx/simulate/smartHomeScenario/' + clientId,
      message: JSON.stringify({
        temp: faker.datatype.number({ min: 15, max: 35 }),     // Generates random temperature between 15 and 35.
        hum: faker.datatype.number({ min: 20, max: 100 }),    // Generates random humidity between 20 and 100.
        lightIntensity: faker.datatype.number({ min: 0, max: 1000 }),  // Generates random light intensity between 0 and 1000.
      })
    }
   }
   // Export the scenario module
   module.exports = {
    name: 'smartHomeScenario',  // Scenario name
    generator,                 // Generator function
   }
   ```

2. In your workspace, create a new JavaScript file, e.g., `smart_home.js`, and paste the script content obtained from ChatGPT.

   ![smart_home.js](https://assets.emqx.com/images/3a93f616060b8463ee780fb7dea43c81.png)

3. Open your terminal or command prompt, and run the following command to publish simulated data:

   ```
   mqttx simulate --file smart_home.js -c 1 -h 127.0.0.1 -t mqttx/chatgpt/smart_home
   ```

   **Notes**:

   - Use the `-c` parameter to adjust the number of simulated device clients.

   - With the `-im` parameter, you can set the data transmission frequency.

   - Ensure the `--file` parameter points to the correct location of the script file, whether it's an absolute or relative path.

4. Lastly, to verify whether the data has been published correctly, you can use the MQTTX desktop or command-line client to subscribe to the `mqttx/chatgpt/smart_home` topic to view the published simulated data.

   ![MQTTX](https://assets.emqx.com/images/75eda80d8b76a6de0a228754dd3a25ed.png)

## Example Scenarios

After understanding the "Quick Start" steps, you can easily expand this foundational knowledge to many practical applications. To help you better understand how to apply these techniques, we will provide examples of common scenarios, demonstrating how to simulate and generate relevant data in areas like vehicular networking and industrial automation. This will assist you in swiftly implementing these methods in your projects for testing.

### Connected Cars (IoV)

1. Scenario Description Prompt:

   ```
   With the advancement of modern technology, the Vehicle Network has become a prominent field. It allows vehicles to communicate with various devices, such as traffic signals, other vehicles, or household appliances. This interaction offers real-time traffic updates, enhances road safety, and improves the driving experience.
   Given this context, please design a data simulation script for the Vehicle Network.
   ```

2. Simulation Script:

   ```
   /**
   * MQTTX Vehicle Network Scenario Example
   * 
   * This script generates car data such as speed, location, fuel tank capacity, tire pressure, door status, and temperature, simulating the real-time condition of the vehicle.
   */
   function generator (faker, options) {
    const randomElement = (arr) => arr[Math.floor(Math.random() * arr.length)];
   
    return {
      message: JSON.stringify({
        speed: faker.datatype.number({ min: 0, max: 220 }),          // Simulating speed from 0 to 220km/h.
        position: {
          lat: faker.address.latitude(),
          lng: faker.address.longitude()
        },                                                          // Simulating the vehicle's GPS location.
        fuelLevel: faker.datatype.float({ min: 0, max: 100 }),      // Simulating fuel tank capacity in percentage.
        tirePressure: {
          frontLeft: faker.datatype.number({ min: 30, max: 40 }),   // Tire pressure (psi).
          frontRight: faker.datatype.number({ min: 30, max: 40 }),
          rearLeft: faker.datatype.number({ min: 30, max: 40 }),
          rearRight: faker.datatype.number({ min: 30, max: 40 }),
        },
        doorStatus: {
          driver: randomElement(['Open', 'Closed']),                // Door status.
          passenger: randomElement(['Open', 'Closed']),
          rearLeft: randomElement(['Open', 'Closed']),
          rearRight: randomElement(['Open', 'Closed']),
        },
        internalTemperature: faker.datatype.float({ min: 15, max: 30 }),  // Internal temperature (Celsius).
        engineStatus: randomElement(['Running', 'Off']),                 // Engine status.
      })
    }
   }
   
   // Export the scenario module.
   module.exports = {
    name: 'vehicleNetworkComplexScenario',   // Scenario name.
    generator,                               // Generator function.
   }
   ```

3. Example:

   ```
   mqttx simulate --file vehicle_network.js -c 1 -h 127.0.0.1 -t mqttx/chatgpt/vechicle
   ```

   ```
   mqttx sub -t mqttx/chatgpt/# -h 127.0.0.1 --format json
   [8/9/2023] [5:49:58 PM] › …  Connecting...
   [8/9/2023] [5:49:58 PM] › ✔  Connected
   [8/9/2023] [5:49:58 PM] › …  Subscribing to mqttx/chatgpt/#...
   [8/9/2023] [5:49:58 PM] › ✔  Subscribed to mqttx/chatgpt/#
   [8/9/2023] [5:49:59 PM] › payload: {
    "speed": 81,
    "position": {
      "lat": "-58.7571",
      "lng": "-57.4411"
    },
    "fuelLevel": 83.26,
    "tirePressure": {
      "frontLeft": 32,
      "frontRight": 35,
      "rearLeft": 34,
      "rearRight": 36
    },
    "doorStatus": {
      "driver": "Closed",
      "passenger": "Open",
      "rearLeft": "Open",
      "rearRight": "Open"
    },
    "internalTemperature": 17.25,
    "engineStatus": "Off"
   }
   ```

### Industrial IoT (IIoT)

1. Scenario Description Prompt:

   ```
   In modern manufacturing plants, the state of various machinery is continuously monitored to optimize performance and prevent breakdowns. Sensors in real-time monitor machine temperature, pressure, and operational duration.
   Given this requirement, please design a data simulation script for the industry.
   ```

2. Simulation Script:

   ```
   /**
   * MQTTX Industrial Scenario Example
   * 
   * This script produces random detailed machine status data, including temperature, pressure, operational duration, bearing temperature, motor RPM, lubrication oil level, and fault codes.
   */
   function generator (faker, options) {
    const randomElement = (arr) => arr[Math.floor(Math.random() * arr.length)];
   
    return {
      message: JSON.stringify({
        temperature: faker.datatype.number({ min: 20, max: 100 }),    // Simulating machine temperature from 20°C to 100°C.
        pressure: faker.datatype.number({ min: 1, max: 10 }),         // Simulating internal machine pressure from 1bar to 10bar.
        runtime: faker.datatype.number({ min: 0, max: 240 }),         // Simulating machine operational duration in hours.
        bearingTemperature: faker.datatype.number({ min: 20, max: 90 }),  // Bearing temperature.
        motorRPM: faker.datatype.number({ min: 1000, max: 5000 }),        // Motor RPM.
        lubricationOilLevel: faker.datatype.float({ min: 0.5, max: 1.5 }), // Lubrication oil level in liters.
        faultCodes: randomElement(['None', 'Overheat', 'High Pressure', 'Low Oil']),  // Machine fault codes.
      })
    }
   }
   
   // Export the scenario module.
   module.exports = {
    name: 'advancedIndustrialScenario',   // Scenario name.
    generator,                            // Generator function.
   }
   ```

3. Example:

   ```
   mqttx simulate --file industrial.js -c 1 -h 127.0.0.1 -t mqttx/chatgpt/industrial
   ```

   ```
   mqttx sub -t mqttx/chatgpt/# -h 127.0.0.1 --format json
   [8/9/2023] [5:56:56 PM] › …  Connecting...
   [8/9/2023] [5:56:56 PM] › ✔  Connected
   [8/9/2023] [5:56:56 PM] › …  Subscribing to mqttx/chatgpt/#...
   [8/9/2023] [5:56:56 PM] › ✔  Subscribed to mqttx/chatgpt/#
   [8/9/2023] [5:56:56 PM] › payload: {
    "temperature": 55,
    "pressure": 6,
    "runtime": 144,
    "bearingTemperature": 36,
    "motorRPM": 4395,
    "lubricationOilLevel": 0.53,
    "faultCodes": "High Pressure"
   }
   ```

## Conclusion

This article provides a straightforward guide on how to utilize AI tools to simulate data generation for IoT scenarios. Acquiring real data often poses challenges during IoT's development and testing phases. Simulated data aids developers in swiftly verifying their solutions' feasibility, robustness, and performance. Moreover, using simulated data ensures that real systems remain undisturbed during testing phases.

The data generation hints or scripts mentioned in this article are merely foundational templates. They might not fulfill all the requirements of intricate real-world scenarios. Fortunately, contemporary AI tools offer a high degree of flexibility, enabling developers to adjust fields and data types as per actual conditions.

In the long run, as AI technology continues to evolve, we anticipate a deeper integration between AI and IoT. In light of this, we are considering integrating AI tools directly into MQTTX to offer users a more convenient and intelligent test data generation experience. Please kindly remain attentive for our further updates.





<section class="promotion">
    <div>
        Try MQTTX for Free
    </div>
    <a href="https://www.emqx.com/en/try?product=MQTTX" class="button is-gradient px-5">Get Started →</a>
</section>
