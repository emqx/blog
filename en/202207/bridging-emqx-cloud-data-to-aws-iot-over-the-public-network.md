This article will introduce how to use the [EMQX Cloud](https://www.emqx.com/en/cloud) data integration feature to bridge data to AWS IoT through the public network so that you can easily use AWS Lambda, Amazon Kinesis, Amazon S3, Amazon Machine Learning, Amazon DynamoDB, Amazon CloudWatch, AWS CloudTrail, and Amazon Elasticsearch Service with built-in Kibana integration to build IoT applications. Collect, process, and analyze data generated by interconnected devices without managing any infrastructure.

## Introduction to AWS IoT

### What is AWS IoT?

Amazon IoT Core is a hosted cloud platform that makes it easy for connected devices to securely interact with cloud applications and other devices. Amazon IoT can support billions of devices and trillions of messages and can process and securely route them to Amazon Cloud Technologies endpoint nodes and other devices. With Amazon IoT, your applications can track and communicate with all your devices at all times, even when they are not connected.

![AWS IoT](https://assets.emqx.com/images/6cab98865f1894be29485ef96af9ad6c.png)

### Benefits of the AWS IoT platform

(1) Broad and deep: AWS has broad and deep IoT services from the edge to the cloud, providing local data collection and analysis capabilities as well as data management and rich analytics integration services on the cloud designed for IoT.                                 

(2) Multiple layers of security: including preventive security mechanisms (such as encryption and access control of device data), continuous monitoring and auditing of security configurations, etc.                   

(3) Superior AI integration: AWS brings AI and IoT together to make devices smarter. Multiple machine learning frameworks are supported.  

(4) Proven at scale: AWS IoT is built on a scalable, secure, and proven cloud infrastructure that scales to billions of different devices and trillions of messages.

## Introduction to EMQX Cloud

EMQX Cloud is a fully managed cloud-native MQTT service from EMQ that connects to massive numbers of IoT devices and integrates with various databases and business systems.

As the world's first fully managed MQTT 5.0 public cloud service, EMQX Cloud provides a one-stop O&M colocation and a unique isolated environment for MQTT messaging services.

In the era of the Internet of Everything, EMQX Cloud can help users quickly build industry applications for the IoT field and can help users quickly build industry applications for the IoT field, and easily realize the collection, transmission, calculation, and persistence of IoT data.

EMQX Cloud is available in dozens of countries and regions around the world, providing low-cost, secure, and reliable cloud services for 5G and Internet of Everything applications, with infrastructure computing facilities provided by cloud providers.

For more information, please visit the EMQX Cloud website or view the EMQX Cloud documentation.

## Bridging Data to AWS IoT with EMQX Cloud

### Turn on NAT gateways

On the EMQX Cloud deployment details page, enable the value-added service, NAT Gateway, to facilitate public network access to AWS IoT.

![EMQX Cloud NAT gateways](https://assets.emqx.com/images/43eb669f156bf0fc0656c9751f731bec.png)

### Configure AWS IoT

1. Create a transaction

   Go to the AWS IoT control panel, find Manage - Transactions, and click Create Transaction to create a transaction named emqx. 

   ![Create a transaction](https://assets.emqx.com/images/c8cd684457560793ca350964f05b4ea2.png)

2. Create and download the certificate

   After creating a transaction, you can directly create a certificate.

   ![Create and download the certificate](https://assets.emqx.com/images/cb32982d2a45fec6e387465a754b35dd.png)

   After the certificate is created, you need to download the certificate on this page for two-way authentication when the device is connected.

   ![download the certificate](https://assets.emqx.com/images/0f4e8d8a7a7576291e3e420d30b720a5.png)

2. Create a policy and associate it with a certificate

   Find Security-Policy, create a policy named emqx-bridge, and write the policy with the following configuration.

   ![Create a policy and associate it with a certificate](https://assets.emqx.com/images/fc482f549120f6f3a47ad9189a2593e3.png)

   ```
   {
     "Version": "2012-10-17",
     "Statement": [
       {
         "Effect": "Allow",
         "Action": "iot:Connect",
         "Resource": "arn:aws:iot:us-east-1:845523974165:client/emqx-bridge_*"
       },
       {
         "Effect": "Allow",
         "Action": "iot:Publish",
         "Resource": "arn:aws:iot:us-east-1:845523974165:topic/emqx/bridge"
       },
       {
         "Effect": "Allow",
         "Action": "iot:Receive",
         "Resource": "arn:aws:iot:us-east-1:845523974165:topic/emqx/bridge"
       },
       {
         "Effect": "Allow",
         "Action": "iot:RetainPublish",
         "Resource": "arn:aws:iot:us-east-1:845523974165:topic/emqx/bridge"
       },
       {
         "Effect": "Allow",
         "Action": "iot:Subscribe",
         "Resource": "arn:aws:iot:us-east-1:845523974165:topicfilter/emqx/bridge"
       }
     ]
   }
   
   ```

   After you finish creating the policy, you need to associate it with the certificate created in the previous step.

   ![AWS IoT](https://assets.emqx.com/images/a18bbe8f796961dfed5a00202df5524c.png)

4. Obtain the public connection address of AWS IoT

   In the settings, get the connection address endpoint for the device connection.

   ![AWS IoT](https://assets.emqx.com/images/39f59b5f7bc1d3d51eebce616b3e7c4e.png)


### Configure EMQX Cloud data integration

Go to the EMQX Cloud deployment page and click Data Integration - MQTT Bridge.

![EMQX Cloud data integration](https://assets.emqx.com/images/7038319a8ada330c0ee533774b44d790.png)

Fill in the resource details for AWS IoT on the Resources page.

![Fill in the resource details for AWS IoT](https://assets.emqx.com/images/74e0272039a851ff407de37430934a74.png)


After confirming the resources are available, configure the rules to filter and process the data.

![configure the rules](https://assets.emqx.com/images/14880ad6fa304d0306c04dae27728ea9.png)

Once the rules are configured, you need to configure the response action, which is to bridge the data to AWS IoT.

![configure the response action](https://assets.emqx.com/images/f7c0de71a65454e1321a78c32e23e81e.png)


After completing Create Resource - Add Rule - Add Action, you can view the information on the details page.

![view the information](https://assets.emqx.com/images/c9aed0ef93d1abc993e283a812e8ffd2.png)


To view the created rules, click on Monitoring to see the current number of successful bridge monitoring is 0, which is the initialization status.

![Monitoring](https://assets.emqx.com/images/0608434d32a771ffbb7543fec3e95b35.png)


## Test Verification

1. Use the Python SDK to connect to the EMQX Cloud deployment and send messages to the topic emqx/bridge. 

   ![connect to the EMQX Cloud](https://assets.emqx.com/images/92c761884c8b197a7f8c673f317547e9.png)

2. Connect to AWS IoT using MQTTX, subscribe to emqx/bridge, and receive messages from the EMQX Cloud deployment. 

   ![Connect to AWS IoT using MQTTX](https://assets.emqx.com/images/bdeb5f6831e9e7527ee9b4481636607e.png)

   ![Connect to AWS IoT using MQTTX](https://assets.emqx.com/images/08bd043b1b481339f507e549ff0e8cfe.png)

3. Check the rule monitoring in the EMQX Cloud console to check the success of bridging data to AWS IoT.

   ![Check the rule monitoring](https://assets.emqx.com/images/5c7d13e46eae482144cd5751604fc3bb.png)

## Summary

Now we have completed the process of bridging data to AWS IoT over the public network using EMQX Cloud data integration. EMQX Cloud's flexible data integration capabilities, combined with AWS IoT's rich application ecosystem, will enable users to create an IoT application in minutes.

<section class="promotion">
    <div>
        Try EMQX Cloud for Free
        <div class="is-size-14 is-text-normal has-text-weight-normal">No credit card required</div>
    </div>
    <a href="https://www.emqx.com/en/signup?continue=https://cloud-intl.emqx.com/console/deployments/0?oper=new" class="button is-gradient px-5">Get Started â†’</a>
</section>
