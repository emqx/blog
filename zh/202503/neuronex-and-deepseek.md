## 前言

工业物联网（IIoT）通过整合 IT 和 OT 理念 ，利用现代流数据处理和边缘计算等先进技术，实现了实时数据监控与分析，能够支持生产流程优化及设备预测性维护、降低停机风险‌、精准定位质量偏差并显著提升良品率‌，推动了制造业的智能化转型与降本增效‌。

EMQ 推出的 NeuronEX 作为一款部署在工业边缘的实时数采和智能分析软件，具备工业设备协议采集、工业各系统数据集成、边端数据过滤分析、AI 算法集成，以及数据转发和平台对接等功能，能够为工业场景提供低延迟的数据接入管理与智能分析服务。

借助 NeuronEX 产品提供的实时流式数据处理能力，用户通常只需编写简单的 SQL 语句即可完成大部分的数据处理任务。但在面对更复杂的数据处理需求时，用户仍需独立编写函数插件进行数据分析，极大地增加了开发和运维难度。为此，本文将介绍如何借助 DeepSeek LLM（大语言模型）的能力来增强 NeuronEX 边缘计算功能，帮助用户更轻松地实现复杂业务数据的处理，显著降低开发成本，并快速响应业务需求的变化。

## NeuronEX 流式数据处理：简洁 SQL 语句解决常见业务需求

NeuronEX 流式计算引擎能够处理从各类数据源接入的数据，提供了包括数据抽取、转换、过滤、排序、分组、聚合和连接等功能。同时，引擎内置了 160 多种函数，涵盖数学运算、字符串处理、聚合运算、哈希运算等，为用户提供了强大的流式计算分析能力。基于这些功能，NeuronEX 可以实现数据过滤清洗、数据标准化、分析监测、实时报警等多种需求。

通常，数据处理的逻辑通过 SQL 方式来实现，例如以下的 SQL 语句实现了对采集的工业数据进行判断，所有 `tag1` 为非 `device_01` 的设备都会被过滤掉，然后将数据按照 5 秒的时间窗口进行聚合。

```sql
SELECT * 
FROM neuronStream 
WHERE tag1="device_01"
GROUP BY TumblingWindow(ss, 5)
```

SQL 处理完成后，用户可以指定将数据写入不同的目标系统，比如发送到 EMQX MQTT Broker，调用远程的 HTTP 服务或 Kafka 以及各种数据库等。

大多数情况下，用户可以通过 SQL 高效地完成业务逻辑的处理。但在逻辑比较复杂的情况下，通过 SQL 方式处理难度很大甚至无法完成，例如以下的客户需求：

- 需求1：点位 tagA，连续 7 个值递增，返回 `{"tagA_alarm":true}` 否则不做输出。
- 需求2：从输入的字符中找出 UTC+0 的时间，时间格式是 YYYY-MM-DD HH:MM:ss，并转化为北京时间，转化后的时间格式为 YY/MM/DD HH:MM；如果从输入的字符中找不到，则返回空。

这主要是因为 SQL 语句的表达能力有限，难以实现复杂的业务逻辑。当需要对数据进行多层次的逻辑判断或复杂计算时，仅依靠 SQL 往往无法满足需求。

为了解决这一问题，NeuronEX 支持通过 Python、Golang 等语言编写扩展函数，以实现更复杂的业务逻辑。但这种方式对用户的技术能力要求较高：

- 需要一定的编程经验和技术基础，非软件开发背景的用户难以独立完成代码编写。
- 开发环境的搭建、调试、打包和部署流程复杂。

这些问题导致用户难以快速实现数据的深度分析与处理，当出现新的业务需求时，往往需要依赖供应商进行开发，这不仅增加了时间成本，也限制了业务的灵活性和创新性。

## NeuronEX+DeepSeek：轻松应对复杂数据处理

为进一步增强 NeuronEX 的数据处理能力，我们借助 DeepSeek 等 LLM 工具提供的推理与编码生成能力，结合 NeuronEX 内置的 Agent 工作流，对上述 Python 函数扩展的过程进行自动化编排与生成，能够快速实现对复杂业务处理逻辑的支持。

**工作流程：**

1. 用户通过自然语言描述业务逻辑，NeuronEX 自动优化提示词并发送给 LLM；
2.  LLM (DeepSeek) 生成 Python 代码，NeuronEX 将生成的代码展示给用户确认；
3. 自动实现 Python 扩展函数的打包、安装和部署，无需手动操作；
4. 用户可以在 NeuronEX 的规则界面，直接调用新安装的扩展函数，实现复杂业务逻辑的处理。

在这个过程中，用户可查看生成的代码，并通过 AI 问答功能深入了解代码逻辑。

**核心价值：**

1. **降低开发门槛：**通过 DeepSeek 为不太熟悉代码开发的业务人员提供数据处理、分析的能力；
2. **提升生产效率：**将复杂数据的开发和分析周期从按天降为按分钟，快速应对业务的变化；
3. **减少开发成本：**减少与技术供应商的需求沟通，极大降低了开发和交付成本。

## 操作演示

### AI 生成函数

通过左侧菜单提供的“编写规则”或者“算法集成”菜单，进入“AI 生成函数”的界面。

- 指定函数配置。
  - 添加函数输入参数的名称、类型，最好加入比较清晰的描述，便于 DeepSeek 更好理解函数实现的功能，提升生成的代码的可读性。
- 在输入框中，通过自然语言描述函数开发需求。
  - 需要对输入的参数处理逻辑进行清晰的描述；
  - 需要对输出结果进行清晰的描述，比如什么情况下返回什么形式的值等，也可以直接提供样例。
- 点击“生成代码”按钮，系统调用 DeepSeek 进行代码生成

![AI 生成函数](https://assets.emqx.com/images/ba0aac7996125f97de52cc45d8b86a2c.png)

### AI 函数助手

代码生成完毕后，在页面的右侧会弹出“AI 函数助手”。

- AI 会根据用户的输入自动生成一个函数名，用户可以点击名称自由更改；
- 界面主体展示了根据自然语言输入而生成的代码，如果对某行代码不清楚，用户可以通过询问 AI 得到对相关代码的解释，帮助用户更好地理解代码逻辑；
- 确认无误后点击“部署函数”，完成函数的部署。

![AI 函数助手](https://assets.emqx.com/images/4b0bb8a01fdf76a31c11bcd262045200.png)

### 测试函数

通过 AI 完成了复杂业务逻辑的开发后，我们回到规则编辑界面。

- 在“SQL 编辑器”中，输入刚实现的自定义函数，并进行测试；
- 在规则的输出界面中，可以看到该自定义函数输出的结果。

只需要几分钟，用户就可以完成一个较为复杂的业务处理函数的开发、测试和使用。

![测试函数](https://assets.emqx.com/images/bc18e812bce1a520819b225dfc093ced.png)

## 总结

通过集成 DeepSeek 等 LLM 工具，NeuronEX 能够高效支持复杂业务数据的处理，帮助生产运维人员和业务使用人员快速实现复杂业务逻辑的开发与部署，无需依赖专业开发团队。这一功能将显著提升业务需求的响应速度，将新业务处理的交付时间从天级缩短至分钟级，降低了开发门槛的同时，大幅提高生产效率。

目前，该功能正在开发与内测阶段，如果您对此感兴趣，欢迎联系 EMQ 销售团队了解更多详情！



<section class="promotion">
    <div>
        咨询 EMQ 技术专家
    </div>
    <a href="https://www.emqx.com/zh/contact?product=solutions" class="button is-gradient">联系我们 →</a>
</section>
