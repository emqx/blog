## 背景

智能物联网设备在 IIoT 场景中有着广泛的应用，但如何管理和监控这些设备是一个挑战。

明道云是一家专业的 hpaPaaS 平台服务商，其所开发的[**明道云平台**](https://www.mingdao.com/)（Mingdao Cloud）是一个企业软件设计和开发工具，让企业可以低代码或无代码搭建个性化的 CRM、ERP、OA、项目管理、进销存等企业信息化系统。

近日，EMQ 与明道云联合打造了面向 IIoT 的零代码应用平台。通过 EMQ 物联网数据基础设施提供的高可靠、高性能实时连接，确保设备信息及时、准确地传输到明道云平台，实现设备数据的监测、工单管理、设备报警等功能，在平台上进行对设备的全方位、智能化管理。

这一联合方案可以帮助企业实现设备的高效管理、数据的实时采集、处理以及应用的快速开发和部署，从而提高生产效率、降低运营成本，实现数字化转型和升级。同时，双方产品的高可靠和高性能也能够保障工厂的数据安全和生产稳定性，为客户创造更大的价值。

## 方案架构

EMQ 和明道云联合打造的 IIoT 零代码平台，旨在简化工业互联网项目的开发和部署过程，为企业提供一种高效、灵活和可靠的解决方案。方案包括 EMQ IIoT数据集成平台和明道云零代码应用平台两部分。

![IIoT 零代码平台架构设计](https://assets.emqx.com/images/70b0d3432349a3623ab48a5dd4454ce9.png)

<center>IIoT 零代码平台架构设计</center>

### EMQ IIoT 数据集成平台

EMQ 提供的 IIoT 数据集成平台主要由以下产品组成：

- [**EMQX**](https://www.emqx.com/zh/products/emqx) 是一款大规模分布式物联网消息接入平台，为高可靠、高性能的物联网实时数据移动、处理和集成提供动力。支持包括 [MQTT](https://www.emqx.com/zh/blog/the-easiest-guide-to-getting-started-with-mqtt)、MQTT-SN、CoAP、LwM2M 等在内的多种协议。在工业物联网场景中，EMQX 可以实现设备与设备、设备与平台之间的高效通信，确保数据实时传输。
- [**Neuron**](https://www.emqx.com/zh/products/neuron) 是一款工业协议网关软件，可将 Modbus、OPC UA、IEC 60870-5-104 等各类不同协议数据统一为标准化的数据格式，方便设备与云平台之间的数据交互。通过与 EMQX 的结合，Neuron 可以实现边缘设备的数据采集和传输。
- [**eKuiper**](https://ekuiper.org/zh) 是一款轻量级的边缘计算框架，可对边缘设备的数据进行实时处理和过滤。通过与 Neuron 的结合，eKuiper 可以实现对采集到的数据进行实时分析，提高数据处理效率，降低数据传输量，减轻云端的计算压力。

![IIoT 数据集成平台](https://assets.emqx.com/images/6706631f0d51326c0fbe00ec67c66409.png)

通过在边缘侧及 [MQTT Broker](https://www.emqx.io/zh) 侧的混合部署，EMQ 的 IIoT 数据集成平台在工业物联网云-边-工厂设备端实现了以下的功能和应用价值：

- 多层次架构：采用云-边-工厂设备多层次架构，将数据处理任务分布在云端、边缘端和工厂端，实现数据处理的灵活性和高效性。
- 实时数据处理：利用边缘计算能力，在边缘端实现实时数据处理，降低响应延迟，提高数据处理效率。
- 数据安全与隐私保护：支持数据加密和访问控制策略，确保数据在传输过程中的安全性和设备的访问权限管理。
- 异常事件处理：可实现对设备数据的实时监控，自动检测异常事件，实时报警，帮助企业及时发现和解决问题。
- 跨协议支持：支持 MQTT、CoAP、LwM2M 等多种物联网协议，便于与各类设备和平台进行对接。
- 高可扩展性：采用分布式架构设计，可实现高可扩展性和高容错性，满足大规模设备接入和消息传输需求。
- 高性能：具有高并发处理能力，支持百万级别的设备连接，确保实时数据传输的稳定性和可靠性。

### 明道云 IIoT 零代码应用平台

通过[**明道云**](https://www.qixiaocloud.com/)和产品内的零代码组件，可以实现 EMQ 传输消息的数据落盘、故障工单、设备管理、业务看板、数据分析和数据监控等应用。

![明道云 IIoT 零代码应用平台](https://assets.emqx.com/images/f88c72ef29c65bb448b59d00aacf77a7.png)

以下是具体实现方法：

- 数据落盘：利用明道云的数据集成组件，可以将 EMQX 传输的消息数据实时接入到明道云工作表中。通过配置数据源、目标工作表和字段映射关系，实现数据的自动同步和存储。也可以通过客户提供的数据作为数据源，实时同步数据库内数据到工作表。
- 故障工单：通过明道云的工作流组件，可以根据设备数据判断设备状态，发生故障时自动生成故障工单。工作流中可以设置条件判断、任务分配、通知提醒等环节，实现设备故障的快速响应和处理。
- 设备管理：利用明道云的工作表组件，可以构建设备信息表，记录设备的基本信息、状态、运行数据等。通过自定义视图，可以实现设备列表、设备详情、设备状态统计等功能，便于设备管理和维护。
- 业务看板：通过明道云的自定义视图组件，可以创建业务看板，展示设备运行状态、故障统计、能耗分析等关键指标。视图支持多种图表类型，如柱状图、饼图、折线图等，可根据需求定制展示内容。
- 数据分析：利用明道云的数据分析组件，可以对设备数据进行统计分析，发现设备运行规律、故障原因等。数据分析组件支持多种统计方法，如求和、平均值、最大值、最小值等，帮助企业优化设备运行和维护策略。
- 数据监控：通过明道云的实时监控组件，可以实时查看设备运行数据，如温度、湿度、压力等。实时监控组件支持多种展示形式，如仪表盘、实时曲线图等，便于企业实时掌握设备运行状况。

综合以上零代码组件，明道云平台可以帮助企业降低开发门槛，提高工业物联网应用的开发效率。

## 方案优势

该联合方案的主要优势如下：

1. 低门槛、零代码开发：借助明道云的零代码开发平台，用户无需具备专业的编程技能，即可通过拖拽、配置等简单操作快速构建工业互联网应用。这降低了企业实施 IIoT 项目的门槛，节省了开发和维护成本，加快了项目上线速度。
2. 高性能、稳定可靠：EMQX 是一款具有高性能、高并发处理能力的物联网消息服务器，支持百万级别的设备连接。结合明道云的强大计算能力，该平台确保实时数据传输的稳定性和可靠性，满足工业互联网应用对实时性和稳定性的高要求。
3. 多协议支持、广泛适用：EMQX 支持 MQTT、CoAP、LwM2M 等多种物联网协议，便于与各类设备和平台进行对接。这使得该平台具有广泛的适用性，可满足不同行业和场景下的 IIoT 应用需求。
4. 数据安全与隐私保护：EMQX 提供数据加密和访问控制策略，确保数据在传输过程中的安全性。明道云平台同样注重数据安全，提供多层次的数据保护措施，包括访问权限控制、审计追踪等功能，保障企业数据的安全和隐私。
5. 边缘计算能力：EMQX 支持边缘计算，可以在边缘端进行实时数据处理，降低响应延迟，提高数据处理效率。这有助于实现工业互联网应用的实时监控和控制，提高生产效率。
6. 强大的数据处理和分析能力：明道云提供丰富的数据处理和分析工具，帮助企业实现数据的快速整合、清洗、分析和可视化。结合 EMQX 的实时数据采集能力，企业可以更好地挖掘数据价值，优化生产过程，提高决策效率。
7. 高度可定制化：明道云平台提供丰富的组件和模板，用户可以根据业务需求进行灵活定制。结合 EMQX 的可扩展性和多协议支持，该平台可以轻松适应各种工业互联网应用场景，满足企业个性化需求。
8. 跨平台协同：明道云支持多种终端设备访问，实现跨平台协同，提高团队工作效率。通过与 EMQX 的集成，企业可以实现设备、数据和人员的无缝连接，推动工业互联网应用的广泛落地。

这些优势使得该平台成为企业实现工业互联网应用的理想选择，有助于推动企业数字化转型和升级。

## 应用场景实践

我们将以工厂常用的耗电监控、空压机和变压器为例，通过网关协议将设备信息实时传输到 EMQ 平台，演示 EMQ 与明道云 IIoT 联合方案如何实现工业物联网设备管理。

此案例场景中，我们的存储数据库采用的是 MySQL 数据库，可以和明道云平台无缝对接。

### 工业协议解析

Neuron 为工业物联网的「连接」而生，支持同时为多个不同通讯协议设备、数十种工业协议进行一站式接入及 MQTT 协议转换，仅占用超低资源，可以原生或容器的方式部署在 X86、ARM 等架构的各类边缘硬件中，助力构建工业物联网应用。Neuron 与 EMQX 集成后可实现各类工业设备的接入，并分发到其他各工业信息系统。

![工业协议解析](https://assets.emqx.com/images/b245563c77f6cb600c67172f6d762778.png)

### 消息规则引擎

EMQX 将 Neuron 采集到的 Modbus 协议数据通过消息引擎进行处理，基于此 EMQX 实现了在近边缘侧的数据清洗和数据路由，便于明道云应用程序直接获取对业务有价值的数据。本次实践采用 MySQL 为客户数据存储所需的数据库，将告警数据、正常的物联网消息数据正确转发到预先建好的数据库中，等待明道云侧的数据表单做数据拉取以及业务应用的调用。

```
SELECT
  id,
  topic,
  payload.node as node_name,
  payload.group as group_name,
  payload.timestamp as tstp,
  payload.values.energy_light3 as energy_light3,
  payload.values.energy_ac3 as energy_ac3,
  payload.values.energy_kyj3 as energy_kyj3,
  payload.values.status_transformer3 as status_transformer3,
  payload.values.temp_transformer3 as temp_transformer3,
  payload.values.alarmset_transformer3 as alarmset_transformer3,
  payload.values.status_kyj3 as status_kyj3,
  payload.values.error_kyj3 as error_kyj3
FROM
  "neuron/neuron_nhjk/upload"
WHERE
  payload.group = 'bei1'
```

```
SELECT
  payload.node as node_name,
  payload.timestamp as tstp,
  payload.group as group_name,
  payload.errors as errors_json
FROM
  "neuron/neuron_nhjk/upload"
WHERE
  json_encode(payload.errors) != '{}' AND is_not_null(payload.errors)
```

### 数据集成

明道云数据集成的核心能力是要解决各个业务系统数据分散的问题。它通过直接对接数据库的方式来实现数据的实时同步。用户只需要配置简单的字段映射规则，就可以实现数据库和工作表的同步，也支持数据库之间的数据同步。

通过明道云集成中心数据集成功能，配置数据库集成信息，目前支持的外部数据库类型包括：MySQL、MariaDB、SQL Server、IBM db2、PostgreSQL。将持续增加其他常见的数据库，如 MongoDB、Oracle等：

![道云集成中心数据集成功能](https://assets.emqx.com/images/2d9cea515ecf42a7cc13c5f7b5f9d3c3.png)

设备运行信息通过明道云集成中心的同步任务，实现数据实施传输到明道云：

![同步任务](https://assets.emqx.com/images/07696eda077c905fe23dd469f3c76aef.png)

设备运行信息数据实时传输到明道云：

![设备运行信息数据](https://assets.emqx.com/images/834a27885ea57f8388eb185386f03723.png)

### 设备档案管理

利用明道云的工作表组件，可以构建设备信息表，自定义字段信息记录设备的基本信息、供应商、运行数据等，对设备的基础信息和运行状态进行管理：

![设备档案管理](https://assets.emqx.com/images/6e183861cfba5c796c74f16010a2e24e.png)

设备信息画廊图：

![设备信息画廊图](https://assets.emqx.com/images/470af44d1924f005aae70bbc2fc0f479.png)

设备信息状态看板：

![设备信息状态看板](https://assets.emqx.com/images/3de610e44f123062422d002b68ab7b70.png)

### 设备监控

利用智能物联网设备，可以采集设备数据，通过 EMQ IIoT 数据集成平台将数据上送到明道云，实现设备的远程监控。在明道云中，通过搭建可视化的仪表盘或报表，直观地展示设备数据，做到实时监控设备。

设备运行看板，告警信息一目了然：

![设备监控](https://assets.emqx.com/images/64bdaaf38f4fb4f29570431f535fa6f2.png)

设备运行异常信息：

![设备运行异常信息](https://assets.emqx.com/images/e009f43703730b00942c152814c2a961.png)

 
### 设备维护

设备的运营需要不断地维护和保养，为了更好地管理和维护工厂设备，明道云提供了工单和任务管理的功能。通过提交工单和任务，可以实现设备的保养和维护，对设备使用过程中出现的问题进行及时排查和解决。既可以人工发现设备故障进行工单提交，也可以通过 EMQ IIoT 数据集成平台推送过来设备运行信息自动触发生成维修工单。

![设备维护](https://assets.emqx.com/images/78f69569b7e6b0e31ecb72881c0b1dab.png)

工单进度管理：

![工单进度管理](https://assets.emqx.com/images/051763ee02772d4c47947e933e1573cc.png)

### 设备报警触发工单

如果设备出现故障或异常，需要及时发送报警通知。在明道云中可以设置报警规则，并通过微信、邮件等方式进行通知，确保设备的问题及时得到解决。

![设备报警触发工单](https://assets.emqx.com/images/ae560f32c14eedf518e708c20ae3db34.png)

告警消息同时触发由工作流的组成的工单系统，在告警同时生成一个维修工单。结合短信、邮件等告警能力确保维修工作能能落实到维修人员，减少故障带来的业务损失。

## 未来展望

通过 EMQ 与明道云的技术整合，企业将能够更轻松地构建和部署工业互联网应用，实现设备、数据和人员的无缝连接，推动生产效率的提升和运营成本的降低。

随着工业互联网的不断发展，EMQ 与明道云联合打造的 IIoT 零代码平台将继续发挥其低门槛、高性能、多协议支持、数据安全、边缘计算能力、数据处理与分析能力、高度可定制化和跨平台协同等优势，助力企业实现数字化转型与升级。在未来，双方将进一步深化合作，共同探索更多创新应用场景，为各行业提供更加完善、智能、高效的解决方案。



<section class="promotion">
    <div>
        联系 EMQ 工业领域解决方案专家
    </div>
    <a href="https://www.emqx.com/zh/contact?product=solutions" class="button is-gradient px-5">联系我们 →</a>
</section>
