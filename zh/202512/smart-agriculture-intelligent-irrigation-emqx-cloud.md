## 引言

为应对全球气候变化和水资源挑战，现代农业急需从粗放的传统灌溉，转型为高效、节水、精准的智能灌溉模式，以满足大规模农场的精细化管理要求。

农业智能灌溉依赖对环境数据的持续采集与灌溉过程的精准控制。因此，底层物联网平台必须具备大规模设备接入能力、高并发消息吞吐能力、实时数据处理能力，以及对复杂网络环境的适应性。

## 项目背景

某农业科技企业专注于农业智能设备研发与生产，产品涵盖喷/滴灌、传感器、管道、阀门等多类智能灌溉设备及配套的智慧灌溉平台。

该平台早期依托阿里云物联网平台进行设备接入，但随着设备规模扩大、业务场景愈加复杂，原有方案在成本控制与水平扩展方面逐渐暴露出局限。为支撑持续增长的业务，该企业最终决定迁移至 [EMQX Cloud](https://www.emqx.com/zh/cloud) 全托管 MQTT 消息服务，以获得更灵活的扩容能力和更优的成本结构。

基于 EMQX Cloud 高可靠、低延迟的通信能力，企业实现了灌溉设备的实时数据采集与远程控制，为农户提供了精准、高效的灌溉管理与监控能力，显著提升了水资源利用效率与作物产量。

## 技术挑战

在平台建设和系统迁移过程中，该农业科技企业面临多重技术挑战：

- **大规模与高并发**

  农田覆盖面积广泛，需要接入成千上万的阀门、传感器等设备，并持续产生大量状态数据和监测数据。平台需要具备高并发数据传输和处理能力。

- **网络环境恶劣**

  农业生产环境网络覆盖不均，设备联网质量差异较大。平台需要在弱网场景保障数据传输的可靠性，借助高效通信协议优化数据传输效率，并支持通过 LoRaWAN 等通信网关组网上云。

- **实时性要求高**

  灌溉调度需要依据实时的土壤湿度、降雨量等环境数据快速决策。平台需要具备毫秒级低时延，避免水资源浪费或作物受损。

- **数据与设备安全**

  灌溉设备关系农业生产安全，平台需要具备 TLS/SSL 加密等灵活的认证和授权策略，确保数据传输与存储的安全可靠。

- **多源数据集成**

  各类传感器与设备数据格式不一、来源分散，平台需要对不同类型的数据进行分类处理并可靠地集成到业务系统，实现统一汇总与分析。

- **季节性弹性伸缩需求**

  灌溉设备连接数与数据流量随种植季节剧烈波动，平台需要具备弹性扩缩容能力，在灌溉高峰期保障性能，在农闲期自动缩减资源以优化成本。

## 解决方案

![image.png](https://assets.emqx.com/images/23e0080a39f28cfa62fc4144a47dea2d.png)

### **设备迁移到 EMQX**

- 对于支持 OTA 升级的设备，通过更换设备侧的 MQTT SDK 重新接入 EMQX Cloud，并使用 Redis 进行认证/授权。
- 对于不便 OTA 的设备，利用 EMQX 的 HTTP 认证/授权功能，实现原有的接入认证授权逻辑，并通过更改 DNS 解析将域名无缝切换到 EMQX Cloud 实例上。

EMQX Cloud 原生支持 [MQTT 协议](https://www.emqx.com/zh/blog/the-easiest-guide-to-getting-started-with-mqtt)，提供灵活的认证/授权机制和无限制的主题通信能力，成为设备平滑迁移的关键。

### **数据采集与上报**

在本地，通过部署 LoRa 网关，有效覆盖大面积设备，降低维护成本和组网复杂度。一方面，网关将采集到的数据通过 MQTT 协议透传至 EMQX Cloud；另一方面，直连设备通过 MQTT 直接接入 EMQX Cloud，并按设定周期发送状态数据。最终确保所有设备数据都能高效、统一地汇集到云平台。

在云端，EMQX 规则引擎根据上报主题对消息进行分流，将不同类型的数据转发至对应的 RabbitMQ 交换机，便于各业务模块针对不同消息来源进行处理。这一流程不仅保证了数据的可靠传输，也实现了业务系统的高度解耦，为后续的数据存储与分析打下了坚实基础。

### **异常检测与应急告警**

平台对上报数据进行实时监控，借助 EMQX 规则引擎筛选异常事件主题，并将相关告警消息发送至 RabbitMQ 独立队列。同时，平台对设备状态事件进行处理，当设备因异常原因离线时，将自动触发告警。

所有异常信息均通过 RabbitMQ 实时同步到业务系统，并通过电话和 APP 推送通知维护人员，实现快速检修，提升系统整体的安全性与可靠性。

### **远程人工控制**

云端平台实时分析各类环境与设备数据，当满足预设条件时，可主动推送通知让用户介入决策；用户也可通过 APP 或 Web 界面发布远程控制指令，经 EMQX Cloud 转发到现场设备，实现开关阀门、调整流量等操作。

基于 MQTT 的双向通信确保了指令的实时下发和设备状态的及时反馈，大大降低了对现场人员的依赖。

### **多源数据融合与可视化**

采集到的各类设备数据经 EMQX Cloud 上报并存储于时序数据库，经过业务系统计算和处理后，再通过 MQTT 推送至可视化大屏。操作人员可实时查看农田环境指标和设备运行状态，优化灌溉决策。

### **操作审计**

针对灌溉系统中的关键操作（如：远程阀门控制），平台通过 EMQX Cloud 规则引擎完整记录操作与设备全生命周期事件（包括：指令下发、设备连接/断开、主题订阅/发布等）。

所有日志由规则引擎推送到 RabbitMQ，经业务系统预处理后持久化存储至数据库，显著提升了系统的可追溯性和运维管理效率。

## 用户收益

该企业基于 EMQX Cloud 的智能灌溉平台使用体验良好，正在分阶段进行增量设备迁移，并计划逐步完成全量设备的迁移。

选择 EMQX Cloud 为该企业带来了以下显著收益：

- **加速开发与创新：**EMQX Cloud 云端搭建和测试仅需数分钟，极大缩短了开发周期。客户开发人员得以专注于设备接入和原型验证，推动业务创新。

- **灵活迁移与扩展：**EMQX 原生支持 MQTT 协议，不受公有云平台限制。灵活的功能设计保障了存量设备的无缝迁移，并能方便、快速地扩展新的业务场景。

- **极致成本优化**：平台支持按需弹性扩缩容。在非灌溉季节可以手动缩减规格降低开支，在灌溉旺季时可以提前扩容节点，从而最大限度地降低基础设施和运维成本。

- **运维负担降低：**作为全托管服务，EMQ 团队负责生产环境的日常运维。客户运维团队可将精力从底层服务器管理中释放，专注于核心业务和产品创新。

- **专业服务保障：**EMQ 提供专业的技术支持服务，协助客户解决架构设计和功能实现中的难题，从而显著提升平台的稳定性和可靠性。

## 总结

通过部署 EMQX Cloud，该农业智能灌溉平台实现了从设备接入、数据采集到远程控制的全链路闭环，保证了灌溉操作的实时性与数据的高可靠性，为农田节水增效与生产数字化提供了坚实支撑。

未来，客户计划持续拓展土壤监测、智能施肥、气候预警等多元农业设备，基于 MQTT 协议实现统一接入与协同管理，逐步构建面向全场景、全周期的智慧农业系统，进一步推动农业生产向精准化、自动化与智能化全面演进。





<section class="promotion">
    <div>
        咨询 EMQ 技术专家
    </div>
    <a href="https://www.emqx.com/zh/contact?product=solutions" class="button is-gradient">联系我们 →</a>
</section>
