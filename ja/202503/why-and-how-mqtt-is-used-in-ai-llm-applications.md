## はじめに

IoT（モノのインターネット）の急速な成長と、特に大規模言語モデル（LLM）を中心としたAIの進化は、インテリジェントで接続されたシステムに新たな可能性をもたらしました。しかし、リアルタイムかつ効率的な通信を必要とする動的な環境では、従来のリクエスト／レスポンス方式だけでは十分ではありません。

[**MQTT**](https://www.emqx.com/ja/blog/the-easiest-guide-to-getting-started-with-mqtt) **(Message Queuing Telemetry Transport)** は、IoTデバイスをAI/MLサービスにブリッジするのに最適な、軽量のパブリッシュ／サブスクライブ型メッセージングプロトコルとして注目を集めています。これはイベント駆動のデータフローを実現し、AIシステムが必要に応じてではなく、常に新鮮なセンサーデータを取り込み、動作できるようにします。ある[AWSのブログ記事](https://aws.amazon.com/blogs/iot/emerging-architecture-patterns-for-integrating-iot-and-generative-ai-on-aws)でも次のように述べられています。

> *「生成AIは、初期の既定の知識を超えて、将来の未知のパラメータに適応するために、新鮮なデータを継続的に供給される必要があります。そこでIoTが重要な役割を果たし、生成AIの可能性を最大限に引き出すのです。」*

MQTTの効率性とスケーラビリティにより、IoTコミュニケーションのスタンダードとなり、AIアプリケーションが必要とするリアルタイムで信頼性の高いデータパイプラインを提供します。

本シリーズでは、**「なぜ、そしてどのようにMQTTがAIアプリケーションやLLM推論で活用されるのか」** について、上層部からエンジニアリングチームまで幅広く理解いただくことを目的として詳しく解説します。今回の第一回では、MQTTの基礎やAIとの連携、技術的アーキテクチャ、そして多様な業界における実例を紹介します。初心者にもわかりやすく、かつ技術的にも深い内容を目指しており、インテリジェントで分散したシステムを実現する上でのMQTTの役割を明らかにします。

------

## MQTTとAI統合の概要

### MQTTとは

MQTTは、**パブリッシュ／サブスクライブ**型のメッセージングプロトコルで、リソースが限られたデバイスや不安定なネットワークを想定して設計されています。HTTPの一方向リクエスト／レスポンス方式とは異なり、MQTTは中央のブローカーを介して、名前付きトピックを通じた双方向通信（パブリッシュ／サブスクライブ）を実現します。一度デバイスが接続すれば、追加のハンドシェイクを何度も行うことなく、任意の数のメッセージを双方向に送受信できます。このアーキテクチャは送信側と受信側を疎結合にし、多数のセンサーやデバイス、サービスがリアルタイムでやり取りする必要がある分散型のIoTやAIシステムに最適です。MQTTは非常に軽量（パケットのオーバーヘッドが少なく、バイナリペイロード、ヘッダも小さい）で、[**Quality of Service (QoS)**](https://www.emqx.com/ja/blog/introduction-to-mqtt-qos) レベルや [**Retained Messages**](https://www.emqx.com/en/blog/mqtt5-features-retain-message)、[**Last-Will Testament**](https://www.emqx.com/ja/blog/use-of-mqtt-will-message) などの機能が、不安定なネットワーク環境下でも信頼性を補完します。

> 「MQTTは、[**パブリッシュ／サブスクライブモデル**](https://www.emqx.com/ja/blog/mqtt-5-introduction-to-publish-subscribe-model) をベースにした軽量メッセージングプロトコルで、低帯域幅かつ不安定なネットワーク環境を想定したIoTアプリケーション向けに設計されています。ネットワークに接続されたデバイスに、最小限のコード量でリアルタイムかつ信頼性の高いメッセージングサービスを提供できます。MQTTはIoT、モバイルインターネット、スマートハードウェア、車載ネットワーク、スマートシティ、遠隔医療、電力、石油、エネルギーなど、さまざまな分野で広く利用されています。」
> — [What Is MQTT and Why Is It the Best Protocol for IoT?](https://www.emqx.com/en/blog/what-is-the-mqtt-protocol)

![img](https://assets.emqx.com/images/22f3bf3adadd2b75112d250d89acf7c9.png)

<center>Publish/Subscribeモデル</center>

### AIやLLMアプリケーションにMQTTを利用する理由

MQTTとAI／LLM推論を組み合わせることで、**IoTデバイスが生成するリアルタイムデータ**と、**データを分析・処理する知能（AI）** の強みを同時に得ることができます。MQTTのイベント駆動型モデルは**即時データ交換**を可能にし、AIが遅延なくリアルタイムで意思決定を行えるようにします。たとえば、LLMを活用したアナリティクスサービスが機械センサーのトピックをサブスクライブしておき、異常な値が検知されればすぐに通知を受け取り、AIベースの異常検知モデルを起動するといったことが可能です。HTTPによるポーリング（定期的にリクエストを送る方式）では、更新を受け取るために頻繁なリクエストが必要ですが、MQTTのプッシュベースのやりとりではデータが生成された瞬間に配信されるため、レイテンシやネットワーク負荷が大幅に抑えられます。

MQTTは、低帯域幅環境でもスケーラブルかつ信頼性の高いデータ伝送を実現するため、IoTコミュニケーションで標準的に利用されてきました。これは、数多くのデータソースからAIシステムなどのコンシューマへ、安定してデータを届ける上で非常に重要です。

さらに、MQTTはデータのプロデューサー（送信元）とコンシューマー（受信先）を疎結合にできる点も大きな利点です。

- AIマイクロサービスを追加または更新しても、他のシステムに影響を及ぼさない
- デバイスのファームウェアを更新しなくても、AIサービス側が購読トピックを変更すれば新たなデータを活用できる
- AIのワークロードの拡張や、プロンプトエンジニアリングの戦略の変更にも柔軟に対応できる

要するに、MQTTはAIを活用するエコシステムにおいて神経系のように作用し、AIの“頭脳”が分散環境で効率よく動作するためのリアルタイムデータフローを実現します。

### 技術的アーキテクチャとメカニズム

MQTTがどのようにAI推論をサポートするのか理解するために、典型的な導入例におけるアーキテクチャとデータフローを見てみましょう。

#### パブリッシュ／サブスクライブ型のデータパイプライン

IoTデバイスはMQTTの*パブリッシャー*として設定されます。それぞれのデバイスは（例：センサー測定値やステータス情報）をトピック（`factory/line1/temperature` のようなパス形式の文字列）にパブリッシュします。一方、AIサービスやLLM推論エンジンは*サブスクライバー*として機能し、（`factory/+/temperature` のようなワイルドカードを使って）必要なトピックを購読します。
[MQTTブローカー](https://www.emqx.com/ja/blog/the-ultimate-guide-to-mqtt-broker-comparison) は中央でそれらを仲介し、発行されたメッセージを該当トピックを購読するすべてのクライアントにリアルタイムで転送します。この際、デバイスはメッセージの受信先を意識する必要がなく、AIサービス側もデバイスを直接問い合わせる必要がありません。ブローカーは何千、何百万ものトピックとクライアントを同時に扱えるため、非常に高いスケーラビリティを確保できます。特にMQTT接続はTCP上で長時間持続するため、一度接続すればHTTPのようにリクエストごとのヘッダや再認証を必要としません。

#### イベント駆動型のAI推論

このアーキテクチャでは、AIアプリケーションはイベント駆動型の動作になります。たとえば、工場でAIを活用した監視システムを考えます。センサーは常時テレメトリ（温度や振動など）をパブリッシュし、AIベースの分析エンジンはそれらのフィードをサブスクライブします。もしあるセンサー値が異常を示した場合、AIエンジンは即座にその情報を受け取り、推論処理（自然言語での警告文生成や、設定値変更の提案など）を実行します。その後の応答や決定事項は再びMQTTで配信され、たとえば`factory/alerts`トピックでダッシュボードやアクチュエータ制御装置へ送られるという仕組みです。

こうした一連のフローはミリ秒～数秒のオーダーで完結し、**リアルタイム性**を実現します。ポーリング方式（数秒～数分ごとに問い合わせる）では問題の発見や対応が遅れがちですが、MQTTの非同期・ノンブロッキングな仕組みを用いれば、多数のイベントやAI推論を同時進行で処理でき、高い処理効率とスループットを得られます。

#### マイクロサービスとLLM推論パイプライン

MQTTはマイクロサービスアーキテクチャのメッセージング基盤としてもよく利用されます。LLM推論のワークフローを、データ収集・集約を担うサービス、LLMをホストまたは呼び出すサービス、結果を処理するサービス、と複数のコンポーネントに分割し、それぞれが**[MQTTトピック](https://www.emqx.com/en/blog/advanced-features-of-mqtt-topics)** を通じて連携できます。
この分割により、（データ収集、推論、ポストプロセスなど）各コンポーネントは独立してスケールやアップデートが可能になり、全体として堅牢で柔軟性の高いシステムを構築できます。

## LLM + MQTTアーキテクチャ図

以下の図は、センサーデータを必要とする多様なIoTおよび産業環境で、エッジとクラウドの両面でLLMサービスを統合する方法の一例を示しています。ファクトリー、自動車、その他のエッジ環境など、リアルタイムでセンサー情報を分析または意思決定する必要がある場面で応用可能です。

![The integration of EMQX MQTT Broker and LLM services](https://assets.emqx.com/images/d44fdd8b26ea20dfbf8f96577475f012.png)

<center>EMQX MQTTブローカーとLLMサービスの統合イメージ</center>

### データ取り込みとエッジ処理

#### クラウドへ直接接続するデバイス

多くのIoTシナリオ（例：コネクテッドカーやスタンドアロンセンサー）では、エンドデバイス自体が既に[MQTTクライアント](https://www.emqx.com/ja/blog/mqtt-client-tools)を搭載しています。これらのデバイスは、安全なMQTT接続をクラウド上のMQTTブローカーと直接確立し、リアルタイムでテレメトリやステータスデータをパブリッシュできます。

#### ファクトリー／産業用エッジゲートウェイ

スマートマニュファクチャリングの現場では、多数のセンサーやPLC、設備がローカルエッジゲートウェイ（例：EMQX Edge）と連携するケースが一般的です。ゲートウェイは、そこに集まったローデータの集約、クリーニング、フィルタリング、変換などを行った上で、クラウドへ送信します。代表的な処理例としては以下があります。

- **データ集約**：複数センサーの読値を平均化するなど、上位レベルの指標にまとめる
- **フィルタリング＆クレンジング**：異常値や範囲外の読値を除去し、下流の分析結果を汚染しないようにする
- **プロトコル変換**：レガシー産業プロトコル（[Modbus](https://www.emqx.com/en/blog/modbus-protocol-the-grandfather-of-iot-communication)、[OPC UA](https://www.emqx.com/en/blog/opc-ua-protocol)など）をMQTTに変換し、クラウド側とシームレスにやりとりできるようにする

こうして処理されたデータストリームが、ゲートウェイから中央MQTTブローカーにパブリッシュされます。ネットワーク負荷を軽減しつつ、クラウドとの接続が不安定なときでもエッジ側で一定の処理が継続できるメリットがあります。

### クラウドMQTTブローカーとLLMの連携

#### ブローカーが中核ハブとして機能

デバイスから直接またはエッジゲートウェイ経由で送られてきたすべてのメッセージは、（例： [EMQX Platform](https://www.emqx.com/en) などの）クラウドMQTTブローカーに集約されます。ブローカーは着信メッセージをトピックごとに仕分けし、登録されたサブスクライバー（たとえばLLMサービスや、他のストレージ／キューシステムなど）へ転送します。

#### LLMへのプロンプト生成と推論

より高度な解析や自然言語でのやり取りが必要な場合は、専用のアプリケーションが該当トピックを購読する、あるいはメッセージを受け取り、そのデータをLLMサービス（ホストされたGPTモデルやオンプレミスの大規模言語モデルなど）に送信します。この専用アプリケーションは以下を行います。

- **プロンプトの構築**：リアルタイムセンサーデータや履歴情報、ユーザーからの質問などを組み合わせて、LLMへの入力文を作成
- **LLM APIの呼び出し**：作成したプロンプトをLLMに送信し、その推論結果を受け取る
- **結果を再度パブリッシュ**：LLMからの応答（自然言語によるインサイトや推奨アクションなど）をMQTT経由でブローカーに送り返す

#### 結果配信と下流連携

- **エッジやエンドデバイスへの返送**：LLMの出力がコマンドやアラートなどのアクションに関するものであれば、ブローカーはそのメッセージを購読中のエッジゲートウェイやデバイスに転送します。たとえば、工場のPLCに対して、センサーの異常を検知したLLMがリアルタイムで設備調整コマンドを送るなどの使い方ができます。
- **ストレージやメッセージキューとの連携**:
  クラウドMQTTブローカーは、LLMの応答や元データなどを追加で他のシステムに転送することも可能です。
  - **データベース**：オリジナルのセンサーデータや処理結果、LLMの出力をPostgreSQLやMySQL、S3などに保存して後からの分析やレポート作成に活用
  - **他のMQシステム**：KafkaやRabbitMQなどのイベントストリーミングプラットフォームにメッセージを転送し、より広範な企業システムやアーカイブに統合

### アーキテクチャのメリット

- **リアルタイムな応答**：MQTTのパブリッシュ／サブスクライブはエッジからLLMサービス、そしてエッジへの戻りまでを低レイテンシかつイベント駆動でつなぐ
- **柔軟なエッジ–クラウド連携**：エッジゲートウェイでの前処理により、クラウド負荷を削減しつつ、ネットワークが不安定でもローカルで動作を継続できる
- **疎結合・スケーラブルな設計**：新しいAI／LLMモジュールを追加してもデバイスファームウェアに変更は不要。ブローカーがすべての送受信を仲介
- **マルチデスティネーション**：1つのデータストリームを分析やダッシュボード、AIなど複数のコンシューマで共有できる
- **拡張性**：データやLLM出力をさらなるストレージやメッセージキューに転送でき、多様なシステム連携に対応

まとめると、MQTTはAIを活用する際の**プラグ・アンド・プレイなアーキテクチャ**を提供します。センサーデータは（必要に応じてエッジで処理された上で）MQTTブローカーにパブリッシュされ、LLMサービスと連携してインサイトやコマンドを生成し、その結果をデバイスやデータベース、ほかのアプリケーションへと届けます。MQTTブローカーはクラウドでもオンプレミスでも稼働可能で、エッジや車載環境にも配置できるため、クラウドレイテンシを排除してローカルでAI推論を実行することも可能です。さらに、MQTTのRetained Message機能を用いれば、AIサービスが再接続した際にも、センサーの最新値を即座に取得でき、開始直後から適切な状態認識が可能です。

## AIとLLM推論のユースケース：MQTTとの統合事例

MQTTの汎用性により、多岐にわたる産業分野でIoTデータとAIによるインテリジェンスを結合した事例が生まれています。以下では、MQTTとLLM/AI推論がリアルタイムの意思決定や自動化を実現している実際のユースケースを紹介します。

### **ソフトウェア・デファインド・ビークル（コネクテッドカー）**

現代の自動車は「走るデータセンター」と呼ばれるほど大量のテレメトリ（エンジン性能、ドライバの挙動、Lidarやカメラのセンサー情報など）を生成し、クラウド経由のアップデートやコマンドで機能を拡張するケースが増えています。

MQTTはコネクテッドカーのプラットフォームで広く使われており、クルマからクラウドへの双方向通信を担います。車載側は車両データ（GPS、診断情報、インフォテインメントの使用状況など）をパブリッシュし、クラウド側はリモートコマンドやソフトウェア更新、AIモデルパラメータなどをサブスクライブさせることで配信可能です。

ソフトウェア・デファインド・ビークルの発展に伴い、次のような要件が生まれています。

> *「テレメトリデータを送信し、更新やコマンド、AI/MLモデルをクラウドから受け取る」*
> [Software-Defined Vehicles Solution](https://www.emqx.com/ja/solutions/software-defined-vehicles)

たとえば、自動運転や半自動運転の車両がMQTTブローカーにセンサー情報を送信し、クラウド上のAIモデル（LLMベースの音声アシスタントや運転支援システムなど）がそれを分析。推論結果に基づいて、ステアリング制御やドライバ警告、ナビルートの最適化を即時にMQTT経由で送り返す、といったリアルタイム連携が可能になります。

### **産業用IoT & スマートマニュファクチャリング**

今日の工場は大量のセンサーや機械設備から常時テレメトリを収集しており、MQTT（および産業データ向け拡張仕様の*Sparkplug B*など）を使ってこれらのデータをAI分析システムに送信するケースが増えています。主なユースケースとしては以下のようなものがあります。

- **予知保全**:
  - 振動や温度センサーがMQTTブローカーへデータを継続的に送信し、AIモデルが異常傾向を解析して故障を事前に予測
  - 効果：設備停止や修理コストの削減
- **AI駆動の品質管理**:
  - 生産ライン上の画像検査システムが検査結果をMQTTでパブリッシュし、AIアルゴリズムが不良品を検知して即座にアラートや調整指示を出す
  - 効果：リアルタイムな意思決定により品質と効率が向上

こうしたMQTT＋AIの組み合わせにより、工場内でのデータ取得から分析、アクションまでのサイクルが自動化され、インテリジェントな生産環境が実現します。

### **スマートホームとコンシューマIoT**

MQTTはスマートホームオートメーションの基盤テクノロジーとして定番であり、センサーやアクチュエータ、AIアシスタントをつなぐ通信レイヤーとして機能します。

近年はLLMやAIを導入することで、スマートホームがより直感的かつ自律的になりつつあります。たとえば、ChatGPTを活用した音声アシスタントがMQTTを介してホームデバイスを制御する、というシナリオです。ユーザーが

*「リビングの照明を消して、室温を72°Fに設定して」*

と言えば、音声アシスタントがその指示をテキスト化し、LLMが意味を解析した上で、MQTTメッセージをパブリッシュしてスマートホームの制御システムに伝達し、実行するわけです。

EMQの[デモンストレーション](https://www.emqx.com/en/blog/natural-interactions-in-iot-combining-mqtt-and-chatgpt) では、NLP + MQTTによってホームデバイス（スイッチ、ライト、明るさ調整など）をChatGPTコマンドでコントロールする様子が紹介されています。これにより、ユーザーの快適性や操作性が大幅に向上します。

また、AIが住人の生活パターンを学習してMQTTメッセージを発行し、照明や暖房を自動で調整したり、エネルギー使用量を要約してアドバイスをしてくれるなど、より高度なホームオートメーションも実現可能です。

最近ではAmazonがAlexa+をリリースし、より自然でコンテクストを理解した会話を可能にする高性能LLMモデルを導入するなど、AnthropicのClaudeなど他のAIプラットフォームも相次いで登場しています。MQTTは、こうした音声制御の次世代スマートホームを支える通信技術として、依然として優位性を保っています。

### **その他の分野：エネルギー、ヘルスケア、スマートシティ**

上記以外にも、MQTT＋AIは数多くの領域で活躍しています。

- **エネルギー管理**: スマートメーターやグリッドセンサーが電力使用量をリアルタイムでMQTT配信。AIが需要変動を分析し、グリッド負荷を最適化したり停電を予測
- **ヘルスケア & リモート患者モニタリング**: ウェアラブル端末や医療機器がMQTTでバイタル情報（心拍、酸素濃度など）を送信。AIが不整脈などの異常を即座に検知し、医師や救急にアラート
- **スマートシティ & 都市インフラ**: 交通センサーや大気センサー、環境モニターが都市全域のデータをMQTTで収集。AIモデルが混雑や汚染を分析し、信号制御や公害対策、公共安全などを最適化

### クラウド統合：MQTTをAIのデータ取り込みレイヤーとして

主要なクラウドプロバイダは、AIやデータ処理サービスへの入力としてMQTTをネイティブにサポートしています。

- AWS IoT Core（MQTTベース）からAWS AIサービスへデータを送る
- Azure IoT HubがMQTT対応のIoTデバイスをAzureのAI分析や意思決定モデルにつなぐ

このように、リアルタイムデータパイプラインとしてMQTTを活用することで、あらゆる産業分野でスケーラブルでイベント駆動型のAIを実現できます。

## まとめ

MQTTのパブリッシュ／サブスクライブモデルとIoT向けの設計思想により、AI自動化の基盤として広く活用されています。工場や自動車、スマートホームといった分野では、IoTデータをリアルタイムでAIに渡し、そこで生成されたインサイトやアクションをデバイス側にフィードバックすることで、高度に自動化されたシステムが実現されています。

## 次回予告

本記事では、MQTTがIoTデバイスとAI/LLMアプリケーションをつなぐ重要な架け橋となっている概要について説明しました。イベント駆動型のアーキテクチャや製造業・自動車業界・スマートホームなどでの事例を通じて、リアルタイムでAIを活用するメリットを見てきました。

しかし、技術の理解はあくまでスタートラインであり、本当の課題は**いかに効果的に実装・運用するか**です。

次回の記事 では、AI駆動プロジェクトにおけるMQTTの導入方法により実践的な視点で迫ります。セキュリティやスケーラビリティ、パフォーマンス最適化のポイント、さらには他の通信プロトコルとの比較にも触れ、どのような構成が自社のAIアーキテクチャに適しているかを解説します。

よくある課題への対処法や、MQTTがAIイノベーションに果たす最新の動向についても取り上げる予定です。

どうぞお楽しみに。MQTTの可能性を最大限に活用して、AIの未来を切り拓きましょう！



<section class="promotion">
    <div>
        専門家と話します
    </div>
    <a href="https://www.emqx.com/ja/contact?product=solutions" class="button is-gradient">お問い合わせ →</a>
</section>
